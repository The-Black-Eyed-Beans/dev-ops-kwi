{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Deploying necessary infrastructure for EKS deployment.",
    "Parameters": {
        "EnvironmentType": {
            "Description": "The Environment type of the stack.",
            "Type": "String",
            "Default": "dev",
            "AllowedValues": ["dev", "test", "prod"],
            "ConstraintDescription": "Specify either dev, test, or prod."
        },
        "VpcId": {
            "Type": "AWS::EC2::VPC::Id",
            "Description": "VPC for project."
        },
        "AppLBArn": {
            "Type": "String",
            "Description": "ARN of the load balancer for the microservices."
        },
        "AppLBDns": {
            "Type": "String",
            "Description": "DNS name of the load balancer for the microservices."
        },
        "GateLBArn": {
            "Type": "String",
            "Description": "ARN of the load balancer for the gateway."
        },
        "GateLBDns": {
            "Type": "String",
            "Description": "DNS name of the load balancer for the microservices."
        },
        "PublicSubnet1Id": {
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Id of the first public subnet of the VPC."
        },
        "PublicSubnet2Id": {
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Id of the second public subnet of the VPC."
        },
        "PrivateSubnet1Id": {
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Id of the first private subnet of the VPC."
        },
        "PrivateSubnet2Id": {
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Id of the second private subnet of the VPC."
        },
        "AppSecGroup": {
            "Type": "String",
            "Description": "Security group for the microservices."
        },
        "GateSecGroup": {
            "Type": "String",
            "Description": "Security group for the gateway."
        },
        "K8sSecGroup": {
            "Type": "String",
            "Description": "Security group for Kubernetes."
        },
        "EcsCluster": {
            "Type": "String",
            "Description": "ECS Cluster for the project."
        },
        "EksCluster": {
            "Type": "String",
            "Description": "EKS Cluster for the project."
        },
        "TaskExecutionRole": {
            "Type": "String",
            "Description": "The Task Execution role for the ECS cluster."
        },
        "TaskRole": {
            "Type": "String",
            "Description": "The Task role for the ECS cluster."
        },
        "ClusterRole": {
            "Type": "String",
            "Description": "The Cluster role for the ECS cluster."
        }
    },

    "Resources": {
        "ResourceSecret": {
            "Type": "AWS::SecretsManager::Secret",
            "Properties": {
                "Name": { "Fn::Sub": "aline-kwi/${EnvironmentType}/secrets/resources" },
                "SecretString": {
                    "Fn::Sub": "{\"VpcId\":\"${VpcId}\",\"AppLoadBalancerArn\":\"${AppLBArn}\",\"AppLoadBalancerDns\":\"${AppLBDns}\",\"GatewayLoadBalancerArn\":\"${GateLBArn}\",\"GatewayLoadBalancerDns\":\"${GateLBDns}\",\"PublicSubnet1\":\"${PublicSubnet1Id}\",\"PublicSubnet2\":\"${PublicSubnet2Id}\",\"PrivateSubnet1\":\"${PrivateSubnet1Id}\",\"PrivateSubnet2\":\"${PrivateSubnet2Id}\",\"AppSecurityGroup\":\"${AppSecGroup}\",\"GatewaySecurityGroup\":\"${GateSecGroup}\",\"KubernetesSecurityGroup\":\"${K8sSecGroup}\",\"EcsCluster\":\"${EcsCluster}\",\"EksCluster\":\"${EksCluster}\",\"TaskExecutionRole\":\"${TaskExecutionRole}\",\"TaskRole\":\"${TaskRole}\",\"ClusterRole\":\"${ClusterRole}\"}"
                }
            }
        }
    }
}